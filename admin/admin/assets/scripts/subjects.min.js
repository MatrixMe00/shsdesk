function removeRow(e){const t=$(e).parents("tr"),a=$(e).parents("form"),s=formatItemId($(t).find("td.cid").text(),"CID",!0),n=formatItemId($(t).find("td.sid").text(),"SID",!0),o=t.find("td.yid").text().replace("Year ","");let i=$(a).find("input[name=course_ids]").val();const l="["+s+"|"+n+"|"+o+"] ";a.find("input[name=course_ids]").val(i.replace(l,"")),t.remove()}current_section=$("#lhs .item.active[data-tab]").attr("data-tab"),ajaxCall=null;var selectedClasses=[],selectedSubject={option:"",value:""};$(document).ready(function(){$(".control button[data-section="+current_section+"]").click()}),$(".control button").click(function(){$(".control button:not(.plain)").addClass("plain"),$(this).removeClass("plain"),$(".section_box").addClass("no_disp"),$("#lhs .item.active").attr("data-tab",$(this).attr("data-section")),$("#"+$(this).attr("data-section")).removeClass("no_disp"),$(this).attr("data-refresh")&&"true"==$(this).attr("data-refresh")&&$("#lhs.menu .item.active").click()}),$("#courseIDs label input").change(function(){let e=$(this).prop("checked"),t=$(this).prop("value");const a=$(this).parents("form");let s=$(a).find("input[name=course_ids]").val();s=e?s.concat(t," "):s.replace(t+" ",""),$(a).find("input[name=course_ids]").val(s)}),$("#classIDs label input").change(function(){let e=$(this).prop("checked"),t=$(this).prop("value");const a=$(this).parents("form");let s=$(a).find("input[name=class_ids]").val();s=e?s.concat(t," "):s.replace(t+" ",""),$(a).find("input[name=class_ids]").val(s)}),$("form").submit(function(e){e.preventDefault();const t=$(this).attr("name");if("delete_form"===t){const e=formSubmit($(this),$(this).find("input[name=submit]"),!1);!0===e||"true"===e?($("tr.remove_marker").remove(),num=parseInt($(".content.orange").find("h2").html())-1,$(".content.orange").find("h2").html(num),$("#table_del").addClass("no_disp")):$("tr.remove_marker").removeClass("remove_marker")}else{const e=jsonFormSubmit($(this),$(this).find("button[name=submit]"));e.then(e=>{e=JSON.parse(JSON.stringify(e)),messageBoxTimeout($(this).prop("name"),e.message,e.status?"success":"error"),e["sms-message"]&&"no-message"!=e["sms-message"]&&alert_box(e["sms-message"],"danger"),!0!==e.status&&"true"!==e.status||(t.includes("update")||setTimeout(()=>{$(this).find("input:not([type=checkbox], [name=school_id])").val(""),$(this).find("input[type=checkbox]").prop("checked",!1)},3e3),$(".control button").attr("data-refresh","true")),"addCourseForm"===$("form").prop("name")&&e.isFirst&&(location.href=location.href)})}}),$("select[name=class_id]").change(function(){var e=$(this).find("option:selected");selectedClasses=[],e.each(function(){let e=$(this);selectedClasses.push({option_name:$(e).text(),option_value:$(e).val()})})}),$("select[name=course_id]").change(function(){var e=$(this).find("option:selected").text(),t=$(this).val();selectedSubject={option:e,value:t}}),$(".item-event").click(function(){const e=$(this).attr("data-item-id"),t=$(this).parents("section").attr("data-table"),a=$(this).parents("section").attr("data-table-col"),s=$(this);let n=!1;if($(this).hasClass("edit")){let o="";"courses"==t?o="updateCourseForm":"teachers"==t&&(o="updateTeacherForm",n=!0),$("#updateItem form").addClass("no_disp"),$("#updateItem").removeClass("no_disp"),ajaxCall=$.ajax({url:$("#updateItem form[name="+o+"]").attr("action"),data:{item_id:e,item_table:t,item_table_col:a,submit:"getItem",isTeacher:n},timeout:3e4,beforeSend:function(){$("#updateLoader").addClass("flex").removeClass("no_disp"),$("#updateItem #getLoader").html(loadDisplay({circular:!0,circleColor:"light"}))},success:function(e){$("#updateItem #getLoader").html(""),$("#updateLoader").addClass("no_disp").removeClass("flex"),e=JSON.parse(JSON.stringify(e));const a=e.results[0];if(!0===e.status){if("courses"===t)$("#updateItem span#courseID").html($(s).parents("tr").children("td:first-child").html()),$("#updateItem form[name="+o+"] input[name=course_name]").val(a.course_name),$("#updateItem form[name="+o+"] input[name=course_alias]").val(a.short_form),$("#updateItem form[name="+o+"] input[name=course_id]").val(a.course_id),$("#updateItem form[name="+o+"] input[name=course_credit]").val(null==a.credit_hours?0:a.credit_hours);else{$("#updateItem form[name="+o+"] span#teacherID").html($(s).parents("tr").children("td:first-child").html()),$("#updateItem form[name="+o+"] input[name=teacher_lname]").val(a.lname),$("#updateItem form[name="+o+"] input[name=teacher_oname]").val(a.oname),$("#updateItem form[name="+o+"] select[name=teacher_gender]").val(a.gender).change(),$("#updateItem form[name="+o+"] input[name=teacher_phone]").val(a.phone_number),$("#updateItem form[name="+o+"] input[name=course_ids]").val(a.course_id),$("#updateItem form[name="+o+"] input[name=teacher_email]").val(a.email),$("#updateItem form[name="+o+"] input[name=teacher_id]").val(a.teacher_id);let e=a.course_id.split(" "),t=a.course_names.split(",");const i=$("#updateItem form table tbody");if(e.pop(),t.pop(),e.length!==t.length)alert_box("Invalid identities presented for classes and subjects","danger");else{$(e).each(function(t,a){var s=a.replace(/^\[|\]$/g,"");e[t]=s}),$(t).each(function(e,a){var s=a.replace(/^\[|\]$/g,"");t[e]=s});for(var n=0;n<e.length;n++){let a=e[n].split("|"),s=t[n].split("|"),o="<tr>";o+='<td class="cid">'+formatItemId(a[0],"CID")+"</td>",o+="<td>"+s[0]+"</td>",o+='<td class="sid">'+formatItemId(a[1],"SID")+"</td>",o+="<td>"+s[1]+"</td>",o+='<td class="yid">Year '+a[2]+"</td>",o+="<td><span class='item-event' onclick='removeRow($(this))'>Remove</span></td>",o+="</tr>",$(i).append(o)}}$("#updateItem table tbody")}$("#updateItem form[name="+o+"]").removeClass("no_disp")}else alert(a)},error:function(e){let t="";t="timeout"===e.responseText?"Connection was timed out. Please check your network and try again":e.responseText,alert_box(t,"light",10)}})}else if($(this).hasClass("delete")){let s=$(this).parents("tr").children("td:nth-child(2)").html();$("#table_del").removeClass("no_disp"),$("#table_del p#warning_content").html("Do you want to remove <b>"+s+"</b> from your records?"),$("#delete_form input[name=item_id]").val(e),$("#delete_form input[name=table_name]").val(t),$("#delete_form input[name=column_name]").val(a),$(this).parents("tr").addClass("remove_marker")}else $(this).hasClass("remove_td")&&$(this).parents("tr").remove()}),$(".add_detail").click(function(){const e=$(this).parents("form"),t=$(e).find("select[name=class_id]"),a=$(e).find("select[name=course_id]"),s=e.find("select[name=class_year]"),n=$(e).find("table");if(selectedClasses.length<1){const t="Please select at least one class";messageBoxTimeout($(e).attr("name"),t,"error")}else if(""===selectedSubject.value){let t="Please select the subject taught by the teacher in ";t+=selectedClasses.length>1?"these classes":"this class",messageBoxTimeout($(e).attr("name"),t,"error")}else if(""==s.val()){const t="Please select the form year to proceed";messageBoxTimeout(e.attr("name"),t,"error")}else{for(i=0;i<selectedClasses.length;i++){const t="["+selectedClasses[i].option_value+"|"+selectedSubject.value+"|"+s.val()+"] ";let a=$(e).find("input[name=course_ids]").val();if("wrong array data"===a&&($(e).find("input[name=course_ids]").val(),a=""),a.includes(t))alert_box("Teacher has been assigned this detail already, "+selectedSubject.option+" at "+selectedClasses[i].option_name);else{let o="<tr>";o+='<td class="cid">'+formatItemId(selectedClasses[i].option_value,"CID")+"</td>",o+="<td>"+selectedClasses[i].option_name+"</td>",o+='<td class="sid">'+formatItemId(selectedSubject.value,"SID")+"</td>",o+="<td>"+selectedSubject.option+"</td>",o+='<td class="yid">Year '+s.val()+"</td>",o+="<td><span class='item-event' onclick='removeRow($(this))'>Remove</span></td>",o+="</tr>",$(n).find("tbody").append(o),$(e).find("input[name=course_ids]").val(a+t)}}t.prop("selectedIndex",-1),a.prop("selectedIndex",0),s.prop("selectedIndex",0),selectedClasses=[],selectedSubject={option:"",value:""}}}),$("#cancelUpdate").click(function(){ajaxCall&&ajaxCall.abort(),$("#updateItem").addClass("no_disp")}),$("#updateItem button[name=cancel]").click(function(){$("#updateItem table tbody").html(""),$("#updateItem").addClass("no_disp")});