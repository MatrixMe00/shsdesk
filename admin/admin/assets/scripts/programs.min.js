current_section=$("#lhs .item.active[data-tab]").attr("data-tab"),ajaxCall=null,$(document).ready(function(){$(".control_btn[data-section="+current_section+"]").click()}),$("#courseIDs label input").change(function(){let t=$(this).prop("checked"),e=$(this).prop("value"),a=$(this).parents("form"),r=$(a).find("input[name=course_ids]").val();r=t?r.concat(e," "):r.replace(e+" ",""),a.find("input[name=course_ids]").val(r)}),$("form[name=addProgramForm]").submit(function(t){t.preventDefault();const e=jsonFormSubmit($(this),$(this).find("button[name=submit]"));e.then(t=>{t=JSON.parse(JSON.stringify(t)),messageBoxTimeout($(this).prop("name"),t.message,t.status?"success":"error"),!0===t.status&&(num=parseInt($(".content.orange").find("h2").html())+1,$(".content.orange").find("h2").html(num),$("#viewAll").attr("data-refresh","true"),setTimeout(()=>{$(this).find("input:not([type=checkbox], [name=school_id])").val(""),$(this).find("input[type=checkbox]").prop("checked",!1)},3e3))})}),$(".control_btn").click(function(){const t=$(this).attr("data-section");$(".section_box:not(.no_disp)").addClass("no_disp"),$("#lhs .item.active").attr("data-tab",t),$("#"+$(this).attr("data-section")).removeClass("no_disp"),$(".control_btn:not(.plain)").addClass("plain"),$(this).removeClass("plain"),$(this).attr("data-refresh")&&"true"===$(this).attr("data-refresh")&&$("#lhs.menu .item.active").click()}),$(".item-event").click(function(){if(item_id=$(this).attr("data-item-id"),$(this).hasClass("edit"))$("#updateProgram").removeClass("no_disp"),ajaxCall=$.ajax({url:$("#updateProgram form").attr("action"),data:{program_id:item_id,submit:"getProgram"},timeout:3e4,beforeSend:function(){$("#updateLoader").toggleClass("no_disp flex"),$("#updateProgram #getLoader").html(loadDisplay({circular:!0,circleColor:"light"}))},success:function(t){$("#updateProgram #getLoader").html(""),$("#updateProgram #getLoader").toggleClass("no_disp flex"),$("#updateProgram form").removeClass("no_disp"),t=JSON.parse(JSON.stringify(t));const e=t.results;if(!0===t.status){const t=e.course_ids.split(" ");""==t[t.length-1]&&t.pop(),$("#updateProgram input[name=program_id]").val(e.program_id),$("#updateProgram input[name=program_name]").val(e.program_name),$("#updateProgram input[type=checkbox]").each((e,a)=>{element_val=$(a).val(),!0===t.includes(element_val)&&$(a).prop("checked",!0)}),$("#updateProgram input[name=short_form]").val(e.short_form),$("#updateProgram input[name=course_ids]").val(e.course_ids)}else alert(e)},error:function(t,e){let a="";a="timeout"===e?"Connection was timed out due to a slow network. Please check your internet connection and try again":"parsererror"===e?"Status: Data returned cannot be parsed. Please try again later else contact admin for help":"Status: "+t.responseText,alert_box(a,"warning color-dark",10)}});else if($(this).hasClass("delete")){let t=$(this).parents("tr").children("td:nth-child(2)").html();$("#table_del").removeClass("no_disp"),$("#table_del p#warning_content").html("Do you want to remove <b>"+t+"</b> from your records?"),$("#delete_form input[name=item_id]").val(item_id),$("#delete_form input[name=table_name]").val("program"),$("#delete_form input[name=db]").val("shsdesk2"),$("#delete_form input[name=column_name]").val("program_id"),$(this).parents("tr").addClass("remove_marker")}else if($(this).hasClass("approve")||$(this).hasClass("reject")){const t=$(this).hasClass("approve")?"accepted":"rejected",e=$(this).parents("table").find("tfoot"),a=$(this).parents("tr");$.ajax({url:$("#updateProgram form").attr("action"),data:{record_token:item_id,record_status:t,submit:"result_status_change"},type:"POST",dataType:"json",timeout:3e4,cache:!1,beforeSend:function(){$(e).addClass("sticky top secondary w-full"),$(e).find(".res_stat").html("Status: Updating...")},success:function(t){$(e).removeClass("sticky top secondary w-full"),t.status,!0===t.status?($(a).remove(),$(e).find(".res_stat").html("The record was "+t.rec_stat),$("#lhs .item.active").click()):$(e).find(".res_stat").html(t.message)},error:function(t,a){let r="";r="timeout"===a?"Status: Connection was timed out. Please check your network connection and try again":"parsererror"===a?"Status: Data returned cannot be parsed. Please try again later else contact admin for help":"Status: "+t.responseText,$(e).find(".res_stat").html(r)}})}else if($(this).hasClass("view")){$("#view_results").removeClass("no_disp");const t=$(this).parents("tr"),e=$(t).find("td:nth-child(2)").html(),a=$(t).find("td:nth-child(3)").html(),r=$(this).attr("data-p-year"),s=$(this).attr("data-p-sem");$("#view_results table tfoot #year_sem").html("Class Year: "+r+" | Class Sem: "+s),$("#view_results #topic").html(a+" results for "+e),$.ajax({url:"./admin/submit.php",data:{submit:"view_results",token_id:item_id},timeout:3e4,beforeSend:function(){const t="<tr class='empty'><td colspan='6'>Fetching results, please wait...</td></tr>";$("#view_results table tbody").html(t)},success:function(t){if(t=JSON.parse(JSON.stringify(t)),$("#view_results table tbody").html(""),!0===t.error){const e="<tr class='empty'><td colspan='6'>"+t.message+"</td></tr>";$("#view_results table tbody").html(e)}else for(var e=0;e<t.message.length;e++){const a=t.message[e],r="<tr><td>"+a.indexNumber+"</td><td>"+a.fullname+"</td><td>"+a.class_mark+"</td><td>"+a.exam_mark+"</td><td>"+a.mark+"</td><td>"+a.grade+"</td></tr>";$("#view_results table tbody").append(r)}},error:function(t){let e=t.responseText;"timeout"==t.textStatus&&(e="Server communication was halted due to slow network. Please check your network and try again"),alert_box(e,"danger",7)}})}else if($(this).hasClass("remove")){let t=$(this).parents("tr").children("td:nth-child(2)").html(),e=$(this).parents("tr").children("td:nth-child(3)").html();$("#table_del").removeClass("no_disp"),$("#table_del p#warning_content").html("Do you want to remove <b>"+e+"</b> uploaded for <b>"+t+"</b> from your records?"),$("#delete_form input[name=item_id]").val(item_id),$("#delete_form input[name=table_name]").val("recordapproval"),$("#delete_form input[name=column_name]").val("result_token"),$("#delete_form input[name=db]").val("shsdesk2"),$(this).parents("tr").addClass("remove_marker")}}),$("form[name=delete_form]").submit(function(t){t.preventDefault();const e=formSubmit($(this),null,!1);!0===e||"true"===e?($("tr.remove_marker").remove(),num=parseInt($(".content.orange").find("h2").html())-1,$(".content.orange").find("h2").html(num),$("#table_del").addClass("no_disp")):($("tr.remove_marker").removeClass("remove_marker"),console.log(e))}),$("#cancelUpdate").click(function(){ajaxCall?ajaxCall.abort():alert("no ajax"),$("#updateProgram").addClass("no_disp")}),$("form[name=updateProgramForm]").submit(function(t){t.preventDefault();const e=jsonFormSubmit($(this),$(this).find("button[name=submit]"));e.then(t=>{t=JSON.parse(JSON.stringify(t)),messageBoxTimeout($(this).prop("name"),t.message,t.status?"success":"error"),!0!==t.status&&"true"!==t.status||$("button.control_btn").attr("data-refresh","true"),"addCourseForm"===$("form").prop("name")&&t.isFirst&&(location.href=location.href)})}),$("label.search-label input[name=search]").keyup(function(){const t=$(this).parents("label"),e=$("#"+t.attr("data-table")),a=e.find("tbody"),r=$(this).val().toLowerCase();if(""!==r){$(a).children("tr").each(function(){const t=$(this).text().toLowerCase();-1===t.indexOf(r)?$(this).hide():$(this).show()});const t=a.children("tr:visible");0===t.length&&alert_box("No results were returned","secondary")}else a.children("tr").show()});