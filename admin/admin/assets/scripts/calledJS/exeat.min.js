$("form[name=exeatForm]").submit(function(e){e.preventDefault(),response=formSubmit($(this),$("form[name=exeatForm] button[name=submit]")),1==response?(message="Exeat provided successfully",type="success",location.reload()):(type="error","no-index"==response?message="Index Number field is empty":"no-town"==response?message="Please provied the exeat town":"no-exeat-date"==response?message="Exeat date has not been provided":"no-return-date"==response?message="Return date has not been provided":"date-conflict"==response?message="Return date cannot be lower than exeat date":"no-exeat-type"==response?message="Please specify the type of exeat":"no-reason"==response?message="Please provide a reason for this exeat":"range-error"==response?message="Reason should range between 3 and 80 characters":"not-student"==response?message="Index number entered cannot be found. Please check and try again":"not-registered"==response?message="Student has not been registered":message=response),messageBoxTimeout("exeatForm",message,type,0)}),$(".item-event.sign-return").click(function(){id=$(this).attr("data-item-id"),parent=$(this).parents("tr"),me=$(this),$.ajax({url:$("form[name=exeatForm]").attr("action"),dataType:"json",type:"POST",data:"submit=markReturn&id="+id,success:function(e){e=JSON.parse(JSON.stringify(e)),"success"==e.status?(ret_date=$(parent).children("td.ret_date").html(e.date),$(parent).children("td.ret").html("Returned"),$(me).remove()):alert_box("Update was unsuccessful","danger")},error:function(){alert_box("An error occured. Please try again later!","danger",8)}})}),$("tbody tr").click(function(){id=$(this).attr("data-item-id"),$.ajax({url:$("form[name=exeatForm]").attr("action"),data:"submit=getExeat&id="+id,dataType:"json",success:function(e){e=JSON.parse(JSON.stringify(e)),"success"==e.status?($(".form .body #indexNumber").val(e.indexNumber),$(".form .body #fullname").val(e.fullname),$(".form .body #house").val(e.house),$(".form .body #exeat_town").val(e.exeat_town),$(".form .body #exeat_date").val(e.exeat_date),$(".form .body #exp_date").val(e.exp_date),e.returnStatus&&$(".form .body #ret_date").show().val(e.ret_date),$(".form .body #exeat_reason").html(e.exeat_reason),$(".form .body #issueBy").val(e.issueBy),e.returnStatus?$(".form .body #returnStatus").val("Student returned to school"):$(".form .body #returnStatus").val("Student not returned to school"),$("#modal").removeClass("no_disp")):alert_box(e.status,"danger",10)},error:function(){alert_box("An error was encountered. Please try again later","danger",10)}})}),$("#modal button[name=cancel]").click(function(){$("#modal .form input").val(""),$("#modal .form .body #exeat_reason").html(""),$("#modal").addClass("no_disp")});