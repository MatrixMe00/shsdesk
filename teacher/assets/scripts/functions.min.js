function loadDisplay(e={size:"",display:"",animation:"",full:!1,circular:!1,span1:"",span2:"",span3:"",span4:"",circleColor:""}){return null!=e.size&&""!=e.size||(wide=$(window).width(),wide<480?e.size="vsmall":wide<720?e.size="small":e.size="med"),null!=e.animation&&""!=e.animation||(e.animation="anim-swing"),null!=e.display&&""!=e.display||(e.display="semi-round"),null!=e.span1&&""!=e.span1||(e.span1="red"),null!=e.span2&&""!=e.span2||(e.span2="yellow"),null!=e.span3&&""!=e.span3||(e.span3="green"),null!=e.span4&&""!=e.span4||(e.span4="teal"),e.full?fullClass="full":fullClass="",null!=e.circleColor&&""!=e.circleColor||(e.circleColor="dark"),e.circular?load='<div class="loader '+fullClass+' circle-loader flex anim-fade" style="--c:8">\n<div class="span-container flex">\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:0"></span>\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:1"></span>\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:2"></span>\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:3"></span>\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:4"></span>\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:5"></span>\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:6"></span>\n<span class="stroke '+e.display+" "+e.circleColor+'" style="--i:7"></span>\n</div>\n</div>':load='<div class="loader flex '+e.animation+" "+fullClass+'" style="--c:4">\n<div class="span-container flex">\n<span class="'+e.size+" "+e.display+" "+e.span1+'" style="--i:0"></span>\n<span class="'+e.size+" "+e.display+" "+e.span2+'" style="--i:1"></span>\n<span class="'+e.size+" "+e.display+" "+e.span3+'" style="--i:2"></span>\n<span class="'+e.size+" "+e.display+" "+e.span4+'" style="--i:3"></span>\n</div>\n</div>\n',load}function toFormData(e){return e instanceof FormData?e:JSONtoFormData(e)}function FormDataToJSON(e){const t={};for(var n of e.entries())t[n[0]]=n[1];return t}function JSONtoFormData(e){const t=new FormData;for(const n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);return t}async function fileUpload(e,t,n=!0){if(!checkFormElement(e,t))return!1;const a=new FormData(e[0],t[0]);return response=null,await $.ajax({url:$(e).attr("action"),data:a,method:$(e).attr("method")?$(e).attr("method"):"POST",dataType:"text",cache:!1,contentType:!1,processData:!1,timeout:3e4,beforeSend:function(){n&&(message=loadDisplay({size:"small"}),type="load",time=0,messageBoxTimeout(e.prop("name"),message,type,time))},success:function(t){n&&$("form[name="+$(e).prop("name")+"] .message_box").addClass("no_disp"),response="success"==t||t},error:function(t,n){message=JSON.parse(JSON.stringify(t)),"timeout"===n&&(message="Connection was timed out due to a slow network. Please try again later"),type="error",messageBoxTimeout(e.prop("name"),message,type)}}),response}async function jsonFileUpload(e,t,n=!0){if(!checkFormElement(e,t))return!1;const a=new FormData(e[0],t[0]);return a.append("response_type","json"),response=null,await $.ajax({url:$(e).attr("action"),data:a,method:$(e).attr("method")?$(e).attr("method"):"POST",dataType:"json",cache:!1,contentType:!1,processData:!1,timeout:3e4,beforeSend:function(){n&&(message=loadDisplay({size:"small"}),type="load",time=0,messageBoxTimeout(e.prop("name"),message,type,time))},success:function(t){n&&$("form[name="+$(e).prop("name")+"] .message_box").addClass("no_disp"),response=t},error:function(t,a){message="Please check your internet connection and try again","timeout"==a&&(messgae="Connection was timed out due to a slow network. Please try again later"),type="error",n&&messageBoxTimeout(e.prop("name"),message,type)}}),response}async function ajaxCall({url:e,formData:t,returnType:n="text",method:a="GET",sendRaw:s=!1,beforeSend:o=null}){let r=!1;try{t instanceof FormData?t.append("response_type",n):t.response_type=n,await $.ajax({type:a,url:e,data:t,dataType:n,contentType:!s&&"application/x-www-form-urlencoded; charset=UTF-8",processData:!s,beforeSend:function(){o()},success:function(e){r=e},error:function(e,t,n){console.error(`Error: ${n}`,e),alert_box(""!=t?t:n,"danger")}})}catch(e){alert_box(e.toString(),"danger"),console.log(e)}return r}function checkFormElement(e,t){return e instanceof jQuery?null===t||t instanceof jQuery?!!$(e).attr("name")||(alert_box("Your form has no attribute name","danger"),!1):(alert_box("Button element is not a jquery object","danger"),!1):(alert_box("Form is not a jquery object","danger"),!1)}function formSubmit(e,t,n=!0){if(!checkFormElement(e,t))return!1;t=null===t||e.find("input[name=submit]").length>0?null:t[0];const a=FormDataToJSON(new FormData(e[0],t));return response=null,$.ajax({url:e.attr("action"),data:a,method:e.attr("method")?e.attr("method"):"POST",dataType:"text",cache:!1,async:!1,timeout:3e4,beforeSend:function(){n&&(message=loadDisplay({size:"small"}),type="load",time=0,messageBoxTimeout(e.prop("name"),message,type,time))},success:function(t){n&&$("form[name="+e.prop("name")+"] .message_box").addClass("no_disp"),"success"==t||t.includes("success")?response=!0:response=t},error:function(t,a){if(message="Please check your internet connection and try again",type="error","timeout"==a&&(message="Connection was timed out due to a slow network. Please try again later"),!n)return message;messageBoxTimeout(e.prop("name"),message,type)}}),response}async function jsonFormSubmit(e,t,n=!0){if(!checkFormElement(e,t))return!1;t=null===t||e.find("input[name=submit]").length>0?null:t[0];const a=FormDataToJSON(new FormData(e[0],t));return a.response_type="json",response=null,await $.ajax({url:e.attr("action"),data:a,method:e.attr("method")?e.attr("method"):"POST",dataType:"json",cache:!1,timeout:3e4,beforeSend:function(){n&&(message=loadDisplay({size:"small"}),type="load",time=0,messageBoxTimeout(e.prop("name"),message,type,time))},success:function(t){n&&$("form[name="+e.prop("name")+"] .message_box").addClass("no_disp"),t=JSON.parse(JSON.stringify(t)),"boolean"==typeof t.status?response=t:"string"==typeof t.status&&("success"==t.status||t.status.includes("success")?response=!0:response=t)},error:function(t,a){message=JSON.stringify(t),type="error","timeout"===a&&(message="Connection was timed out due to a slow network. Please try again later"),n?messageBoxTimeout(e.prop("name"),message,type,0):alert_box(message,"danger")}}),response}function alert_box(e,t="primary",n=5){$("body").find("#alert_modal").length<1&&(alert_modal='<div id="alert_modal" class="fixed flex flex-column flex-align-end"></div>',$("body").append(alert_modal)),my_number=$("#alert_modal").children(".alert_box").length,box='<div class="alert_box '+t+'" id="alert_box'+(my_number+1)+'"> <div class="message">     <span>'+e+"</span> </div></div>",$("#alert_modal").append(box),removeAlert("alert_box"+(my_number+1),n)}function removeAlert(e,t){t>0&&setTimeout(function(){$("#"+e).remove()},1e3*t)}function selectChartColors(e,t=0){var n=[];const a=["line","scatter"];if(a.includes(e.toLowerCase())||1===t){let e=parseInt(1e3*Math.random()%chartColors.length);n.push(chartColors[e])}else if(t>1){let e=[],a=0;for(;a<t;){let t=parseInt(1e3*Math.random()%chartColors.length);e.includes(t)||(e.push(t),n.push(chartColors[t]),++a)}}return n}function giveGrade(e,t="wassce"){let n="";switch(t){case"wassce":n=e>=80?"A1":e>=70?"B2":e>=65?"B3":e>=60?"C4":e>=55?"C5":e>=50?"C6":e>=45?"D7":e>=40?"E8":"F9";break;case"ctvet":n=e>=80?"D":e>=60?"C":e>=40?"P":"F"}return n}function isJSON(e){let t=!1;try{JSON.parse(JSON.stringify(e));t=!0}catch(e){t=!1}return t}function fillTable({table_id:e,result_data:t,first_countable:n=!0,has_mark:a,mark_index:s,mark_first:o=!1,mark_result_type:r="wassce",options:l=[],reject:c=null}){const d=$("#"+e).find("tbody");$(d).html("");const u="object"==typeof t[0];let p=!1;if(null!==u&&u){const e=removeKeys(Object.keys(t[0]),c),u=getIndexes(l,s);for(i=0;i<t.length;i++){let c="<tr>";for(n&&(c+="<td>"+(i+1)+"</td>",s&&!p&&(--s,p=!0)),j=0;j<e.length;j++){if(a&&s-1==j&&!1===o&&(c+="<td>"+giveGrade(t[i][e[j]],r)+"</td>\n"),u&&u.some(e=>e.indexKey===j)){const n=u.find(e=>e.indexKey===j),a=l[n.position];let s=t[i][e[j]];if(c+="<td",c+=a.class||""!=a.class?' class="'+a.class+'"':"",a.attributes)for(k=0;k<a.attributes.length;k++){const e=a.attributes[k].value;c+=" "+a.attributes[k].name+' = "'+t[i][e]+'"'}a.format_function&&"function"==typeof window[a.format_function]&&(s=window[a.format_function](s)),c+=">"+s+"</td>\n"}else c+="<td>"+t[i][e[j]]+"</td>\n";a&&s-1==j&&!0===o&&(c+="<td>"+giveGrade(t[i][e[j]],r)+"</td>")}c+="</tr>",$(d).append(c)}}else alert_box("Table cannot be populated because there are no keys to generate for a table","warning color-black",10)}function removeKeys(e,t){return null!==t||Array.isArray(t)&&t.length>0?e.filter(e=>!t.includes(e)):e}function getIndexes(e,t){let n=null;return Array.isArray(e)&&e.length>0&&(n=[],e.forEach((e,a)=>{"index"in e&&("mark_index"==e.index&&(e.index=t),e.index=e.index-1,n.push({indexKey:e.index,position:a}))})),n}function createOptionsTD(e){}function formatItemId(e,t,n=!1){return n?(e=e.toUpperCase(),e=e.replace(t,"").replace(" ",""),e=parseInt(e)):(e=e.toString().padStart(4,"0"),e=`${t} ${e}`),e}function insertEmptyTableLabel(e,t,n=!1){return"<tr class='empty"+(n?" no_disp":"")+"'><td colspan='"+t+"'>"+e+"</td></tr>"}async function deleteTokenResults(e,t="results"){await $.ajax({url:"./submit.php",data:{submit:"delete_token",token:e,table:t},timeout:3e4,success:function(e){"success"==e?"results"==t&&alert_box("Result ready for re-entry","secondary"):(alert_box(e,"danger"),console.log(e))},error:function(e){console.log(e),alert_box("Unknown error occured","danger")}})}async function create_result_head(e,t,n,a,s){let o=!1,r=$("label[for=academic_year] #academic_year").length>0?$("#academic_year").val():0;return await $.ajax({url:"./submit.php",data:{result_token:e,course_id:t,program_id:n,semester:a,exam_year:s,submit:"submit_result_head",academic_year:r},method:"POST",success:function(e){"success"==e?(o=!0,console.log("result slip head created")):(alert_box("Result slip head failed to create on init","danger"),console.log(e))},error:function(e){console.log(e),alert_box("Unknown error! Refer to logs","danger")}}),o}function positionFormat(e){e=parseInt(e,10);let t="";switch(e%10){case 1:t=e>20||e<10?"st":"th";break;case 2:t=e>20||e<10?"nd":"th";break;case 3:t=e>20||e<10?"rd":"th";break;default:t="th"}return e+t}function getNextEditableElement(e,t=".class_score, .exam_score"){let n=$(t),a=n.index(e),s=(a+1)%n.length;return n.eq(s)}function assignPositions(e){const t=e.find("td.total_score").map(function(){return{score:parseFloat($(this).text()),index:$(this).closest("tr").index()}}).get();t.sort((e,t)=>t.score-e.score);let n=0,a=-1;t.forEach((t,s)=>{t.score!=a&&(a=t.score,n=s+1),e.find("tr").eq(t.index+1).find("td.position").text(positionFormat(n)).attr("data-position-value",n)})}function insertFailedReason(e,t={},n="fail-reason",a="fail_block"){const s=$("#"+a).find("tbody");s.empty(),e&&Object.keys(e).length>0?Object.entries(e).forEach(([e,n])=>{const a=t[e]||"",o=`\n                <tr>\n                    <td class="index_number">${e}</td>\n                    <td class="lastname">${a}</td>\n                    <td>${n}</td>\n                </tr>`;s.append(o)}):s.append('\n            <tr>\n                <td colspan="3">No failed reasons found</td>\n            </tr>'),$("#"+n).removeClass("no_disp")}function getSelectedStudents(e){const t={};return e.find("tbody tr").each(function(){const e=$(this),n=e.find(".td-student input[type=checkbox]").is(":checked");if(n){const n=e.find("td.index_number").text().trim(),a=e.find("td.lastname").text().trim();n&&(t[n]=a||"")}}),t}function delay(e){return new Promise(t=>setTimeout(t,e))}chartColors=["#007bff","#6610f2","#6f42c1","#e83e8c","#dc3545","#fd7e14","#ffc107","#28a745","#20c997","#17a2b8","#6c757d","#343a40","#EF5777","#575FCF","#48D0FA","#35E7E4","#0CE881","#F53B57","#3D40C6","#10BCF9","#00D8D6","#04C56B","#FFC048","#FFDD59","#FF5E58","#48545F","#FFA8D0","#FFD32A","#FF3F34","#818E98","#182027"];