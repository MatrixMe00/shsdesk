function admissionFormButtonChange(){total=$(".tabs").children("span.tab_button").length;for(var e=1;e<=total;e++){if($(".tabs span.tab_button:nth-child("+e+")").hasClass("active")&&e<total){$("button[name=submit_admission] span").html("Next"),$("button[name=submit_admission]").prop("disabled",checkForm(e)),admission_button_tab_index=e;break}if($(".tabs span.tab_button:nth-child("+e+")").hasClass("active")&&e==total){$("button[name=submit_admission] span").html("Save"),$("button[name=submit_admission]").prop("disabled",checkForm(e));break}}}function printSection(e,a,t="Print View"){const n=window.open("",t);n.document.write("<html><head><title>"+t+"</title></head><body>"),n.document.write(e),n.document.write("</body></html>"),n.document.head.innerHTML+=a,n.document.close(),n.print()}function printTime(){var e=new Date,a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=a[e.getMonth()],n=e.getDate(),o=e.getFullYear(),s=e.getHours(),i=e.getMinutes(),r=e.getSeconds(),m=s>=12?"pm":"am";s%=12,s=s||12;var l=t+" "+n+", "+o,d=s+":"+(i<10?"0":"")+i+":"+(r<10?"0":"")+r+" "+m,c=l+" at "+d;return c}var admission_button_tab_index=1,url=location.protocol+"//"+location.host+"/"+location.pathname.split("/")[1];$(document).ready(function(){$("span.tab_button:nth-child(1)").click(),$("form[name=admissionForm] button[name=modal_cancel]").click()}),$("select[name=ad_month]").change(function(){if(html1="<option value=''>Select Your Day of Birth</option>",$("select[name=ad_day]").html(html1),""!=$("select[name=ad_year]").val()){days=31,this_month=parseInt($(this).val()),lunar_year=parseInt($("select[name=ad_year]").val()%4),0==lunar_year&&(lunar_year=parseInt($("select[name=ad_year]").val()%400)),4==this_month||6==this_month||9==this_month||11==this_month?days=30:2==this_month&&0==lunar_year?days=29:2==this_month&&0!=lunar_year&&(days=28);for(var e=1;e<=days;e++)new_option="<option value='"+e+"'>"+e+"</option>",$("select[name=ad_day]").append(new_option)}}),$("select[name=ad_year]").change(function(){""!=$("select[name=ad_month]").val()?$("select[name=ad_month]").change():(html1="<option value=''>Select Your Day of Birth</option>",$("select[name=ad_day]").html(html1))}),$("button[name=modal_cancel]").click(function(){admission_button_tab_index=1;const e=$(this).parents(".form_modal_box");if(e.addClass("no_disp"),"payment_form"==e.prop("id")){$("form[name=paymentForm] input").prop("disabled",!1),$("form[name=paymentForm]")[0].reset(),$("button[name=student_cancel_operation]").click(),$("#pay_amount").prop("readonly",!0);const e=$("form[name=paymentForm] input#pay_amount").attr("data-init");$("#pay_amount").val("GHC "+e)}else if("admission"==e.prop("id")){$("#ad_index").prop("readonly",!1),$("form[name=admissionForm] label[for=continue]").removeClass("no_disp"),$("form[name=admissionForm] label[for=submit_admission]").addClass("no_disp"),$("button[name=submit_admission]").prop("disabled",!0).prop("type","button"),$(".tabs span.tab_button").addClass("no_disp").removeClass("incomplete"),$(".tabs span.tab_button:first-child").removeClass("no_disp").click(),resetAccepts(),$("form[name=admissionForm]")[0].reset(),$("#interest").val(""),$("#admission input[required], #admission input.required").blur(),$("#admission select[required], #admission select.required").change();const e=$("form[name=paymentForm] input#pay_amount").attr("data-init");$("form[name=paymentForm] input#pay_amount").val("GHC "+e)}}),$("button[name=submit_admission]").click(function(){total=$(".tabs").children("span.tab_button").length,admission_button_tab_index<total&&(admission_button_tab_index+=1),$(".tabs span.tab_button:nth-child("+admission_button_tab_index+")").click()}),$("label[for=agree]").click(function(){check=$("label[for=agree] input[name=agree]").prop("checked"),0==check?($("button[name=submit_admission]").prop("type","button"),$("button[name=print_summary]").prop("disabled",!0)):1==check&&($("button[name=submit_admission]").prop("type","submit"),$("button[name=print_summary]").prop("disabled",!1)),$("button[name=submit_admission]").prop("disabled",!check)}),$("input.tel").keyup(function(){val=$(this).val(),maxlength=10,"+"==val[0]&&val.includes(" ")?maxlength=16:"+"!=val[0]||val.includes(" ")?"0"==val[0]&&val.includes(" ")?maxlength=12:"0"!=val[0]||val.includes(" ")?$(this).val(""):maxlength=10:maxlength=13,$(this).prop("maxlength",maxlength)}),$("input.tel").blur(function(){if(i=0,value=$(this).val(),value.includes(" ")){for(value=value.split(" "),length=0,new_value="";length<value.length;)new_value+=value[length],length++;value=new_value}if("0"==value[0]){for(new_val="+233",i=1;i<=9;)new_val+=value[i],i++;value=new_val}$(this).val(value)}),$(".tabs span.tab_button").click(function(){$(".tabs span.tab_button").removeClass("active"),$(this).addClass("active"),$(".form_views > div").addClass("no_disp"),$("#"+$(this).attr("data-views")).removeClass("no_disp"),admissionFormButtonChange()}),$("#admission select").change(function(){admissionFormButtonChange()}),$("#admission input").blur(function(){admissionFormButtonChange()}),$("#view2 .checkbox").click(function(){admissionFormButtonChange()}),$("#payment_button, .enrol_button").click(function(){$("#payment_form").removeClass("no_disp").addClass("flex"),$("form[name=admissionForm] #enrol_field").removeClass("no_disp"),$("form[name=paymentForm] #school_choice").html($("#school_admission_case #school_select option:selected").html()),$(".tabs span.tab_button.active").removeClass("no_disp")}),$("#payment_form form input").keyup(function(){""!=$("#pay_fullname").val()&&""!=$("#pay_phone").val()||""!=$("#pay_reference").val()?($("#payment_form form button[name=submit]").prop("disabled",!1),$("#payment_form form label.btn_label img").prop("src",url+"/assets/images/icons/lock-open-outline.svg")):($("#payment_form form button[name=submit]").prop("disabled",!0),$("#payment_form form label.btn_label img").prop("src",url+"/assets/images/icons/lock.png"))}),$("label.ad_interest input").change(function(){let e=$(this).prop("checked"),a=$(this).attr("data-value");const t=$("input#interest");let n=t.val().split(", ");""===t.val()&&(n=[]),e?n.push(a):n=$.grep(n,function(e){return e!==a}),t.val(n.join(", ")),$("#interest_value").html(n.join(", "))}),$("#ad_index").keyup(function(){index_val=$(this).val(),index_val.length>=4?$("button[name=continue]").prop("disabled",!1):$("button[name=continue]").prop("disabled",!0)}),$("button[name=activate_student_index_number]").click(function(){$("#activate_index_number").removeClass("no_disp").addClass("flex-all-center fixed"),$("#check_index_number").val($("#student_index_number").val())});const reset_activation_fields=()=>{const e=$("#check_index_number"),a=$("#checkIndexButton"),t=$("datalist#student_names");t.empty(),e.prop("readonly",!0),a.prop("disabled",!0),$("#check_status_span").addClass("not-visible").html("")};$("#check_school_id").change(async function(){const e=$(this).val(),a=$(this).find("option:selected"),t=$("select#check_programme");if(t.html('<option value"">Select a Programme</option>'),reset_activation_fields(),""!=e){if(""==a.attr("data-programs")){let t=await ajaxCall({url:"./submit.php",returnType:"json",method:"POST",beforeSend:function(){$("#check_status_span").removeClass("not-visible").html("Fetching programs...")},formData:{submit:"get_cssps_programs",school_id:e}});if(t=t.data,"object"!=typeof t)return alert_box(t,"error"),$("#check_status_span").html(t),void setTimeout(function(){$("#check_status_span").addClass("not-visible").html("")},1e4);$("#check_status_span").addClass("not-visible"),a.attr("data-programs",JSON.stringify(t))}var n=JSON.parse(a.attr("data-programs"));$.each(n,function(e,a){t.append('<option value="'+a+'">'+a+"</option>\n")})}}),$("#check_programme").change(async function(){const e=$(this).val(),a=$("#check_school_id").val(),t=$("datalist#student_names"),n=$("#students_index"),o=$("#students_index_hidden"),s=$("#students_index_hashed");if(t.empty(),n.val("").prop("readonly",!1),o.val(""),s.val(""),""!=e){let s=await ajaxCall({url:"./submit.php",returnType:"json",method:"POST",beforeSend:function(){$("#check_status_span").removeClass("not-visible").html("Fetching students...")},formData:{submit:"get_cssps_students",school_id:a,programme:e}});if(s=s.data,"object"!=typeof s)return alert_box(s,"error"),$("#check_status_span").html(s),n.val("").prop("readonly",!0).attr("placeholder","No assigned students"),o.val(""),void setTimeout(function(){$("#check_status_span").addClass("not-visible").html("")},1e4);n.attr("placeholder","Search your name here"),$("#check_status_span").addClass("not-visible"),$.each(s,function(e,a){t.append('<option value="'+a.fullname+'" data-hidden-index="'+a.hidden_index+'" data-temp-index="'+a.indexNumber+'" >'+a.fullname+"</option>")})}}),$("#students_index").on("input",function(){const e=$("datalist#student_names"),a=$(this).val(),t=$("#students_index_hashed"),n=$("#students_index_hidden"),o=$("#check_index_number"),s=$("#checkIndexButton");if(""!=e.html()&&e.find("option[value='"+a+"']").length>0){const i=e.find("option[value='"+a+"']").attr("data-hidden-index"),r=e.find("option[value='"+a+"']").attr("data-temp-index");t.val(i),n.val(r),o.prop("readonly",!1),s.prop("disabled",!1)}else o.prop("readonly",!0),s.prop("disabled",!0)}),$("form[name=indexNumberCheckerForm]").submit(async function(e){e.preventDefault();const a=$(this),t=formSubmit(a,a.find("#checkIndexButton"),!0);!0===t?(messageBoxTimeout("indexNumberCheckerForm","Your index number has been activated","success"),setTimeout(function(){a.find("button[name=cancel]").click()},5e3)):messageBoxTimeout("indexNumberCheckerForm",t,"error")}),$("form[name=indexNumberCheckerForm] button[name=modal_cancel]").click(function(){reset_activation_fields()}),$("button[name=continue]").click(function(){index_number=$("#ad_index").val(),school_id=$("#student #school_select").val(),dataString="submit=getStudentIndex&index_number="+index_number+"&school_name="+$("#school_admission_case #school_select option:selected").html()+"&school_id="+school_id,$.ajax({url:$("form[name=admissionForm]").attr("action"),type:"GET",data:dataString,dataType:"json",cache:!0,async:!1,timeout:3e4,beforeSend:function(){$("#view1 .para_message").html("Checking index number, please wait..."),alert_box("Retrieving CSSPS data...","secondary",2)},success:function(e){$("#view1 .para_message").html("Parts with * means they are required fields"),data=JSON.parse(JSON.stringify(e)),"success"==data.status?($("form[name=admissionForm] #ad_aggregate").val(data.aggregate),$("form[name=admissionForm] #ad_course").val(data.programme),$("form[name=admissionForm] #ad_lname").val(data.Lastname),$("form[name=admissionForm] #ad_oname").val(data.Othernames),$("form[name=admissionForm] #ad_gender").val(data.Gender),$("form[name=admissionForm] #ad_jhs").val(data.jhsAttended),$("form[name=admissionForm] #ad_lname, form[name=admissionForm] #ad_oname, form[name=admissionForm] #ad_jhs").blur(),$("form[name=admissionForm] #ad_gender").change(),$("#res_ad_aggregate").html(data.aggregate),$("#res_ad_course").html(data.programme),$("#res_ad_lname").html(data.Lastname),$("#res_ad_oname").html(data.Othernames),$("#res_ad_gender").html(data.Gender),$("#fullCandidateName").html(data.Lastname+" "+data.Othernames),$("form[name=admissionForm] label[for=continue]").addClass("no_disp"),$("label[for=submit_admission]").removeClass("no_disp"),$("form[name=admissionForm] fieldset").removeClass("no_disp"),$("form[name=admissionForm] #enrol_field label").removeClass("no_disp"),$("#shs_placed").val($("#school_admission_case #school_select option:selected").html()),$("#res_shs_placed").html($("#shs_placed").val()),$("#ad_index").prop("readonly",!0),alert_box("CSSPS data has been filled","success",1.5),$("#admission").removeClass("no_disp"),ajaxCall({url:$("form[name=admissionForm]").attr("action"),formData:{submit:"get_programs",course_name:data.programme,school_id:school_id},method:"GET"}).then(e=>{if("none"==e)$("#class_fieldset").addClass("no_disp"),$("#program_display_val").text("N/A"),$("#program_select").html("");else if($("#program_select").html(""),is_json_string(e))for(e=JSON.parse(e),e.length>1&&$("#program_select").html('<option value="">Select preferred Class</option>'),i=0;i<e.length;i++){const a=e[i],t='<option value="'+a.id+'" data-courses="'+a.courses+'">'+a.name+"</option>";$("#program_select").append(t)}})):"wrong-school-select"==data.status?($("#view1 .para_message").html("Incorrect school chosen. Select your right school to continue and enter your transaction ID to continue"),$("form[name=admissionForm] button[name=continue]").prop("disabled",!0),$("#ad_enrol").prop("readonly",!0),$("button[name=modal_cancel]").prop("disabled",!0),setTimeout(function(){$("#view1 .para_message").html("Parts with * means they are required fields"),$("form[name=admissionForm] button[name=continue]").prop("disabled",!1),$("#ad_enrol").prop("readonly",!1),$("button[name=modal_cancel]").prop("disabled",!1),$("form button[name=modal_cancel]").click()},5e3)):"wrong-index"==data.status?($("#view1 .para_message").html("Incorrect or invalid index number provided. Please check and try again"),$("form[name=admissionForm] button[name=continue]").prop("disabled",!0),$("#ad_enrol").prop("readonly",!0),$("button[name=modal_cancel]").prop("disabled",!0),setTimeout(function(){$("form[name=admissionForm] button[name=continue]").prop("disabled",!1),$("#ad_enrol").prop("readonly",!1),$("button[name=modal_cancel]").prop("disabled",!1)},3e3),setTimeout(function(){$("#view1 .para_message").html("Parts with * means they are required fields")},5e3)):"already-registered"==data.status?($("#view1 .para_message").html("You are identified as having enrolled already. Please go to shsdesk.com/student to access your documents"),$("form[name=admissionForm] button[name=continue]").prop("disabled",!0),$("#ad_enrol").prop("readonly",!0),$("button[name=modal_cancel]").prop("disabled",!0),setTimeout(function(){$("form[name=admissionForm] button[name=continue]").prop("disabled",!1),$("#ad_enrol").prop("readonly",!1),$("button[name=modal_cancel]").prop("disabled",!1)},3e3),setTimeout(function(){$("#view1 .para_message").html("Parts with * means they are required fields")},7e3)):alert_box("Your data could not be retrieved. Please try again with your transaction ID","warning",7)},error:function(e,a){let t=JSON.stringify(e);"timeout"==a&&(t="Connection was timed out due to a slow network. Please try again later"),$("#view1 .para_message").html(t),setTimeout(function(){$("#view1 .para_message").html("Parts with * means they are required fields")},5e3)}})}),$("#program_select").change(function(){if($("#course_displays").html(""),$("#program_display_val").text("Not Set"),""!=$(this).val()){const e=$(this).find("option:selected");$("#course_displays").html(e.attr("data-courses")),$("#program_display_val").text(e.text())}}),$("form[name=admissionForm] button[name=modal_cancel]").click(function(){$("button[name=continue]").removeClass("no_disp"),$("label[for=submit_admission]").addClass("no_disp"),$("form[name=admissionForm] fieldset").addClass("no_disp"),$("form[name=admissionForm] fieldset#enrol_field").removeClass("no_disp"),$("form[name=admissionForm] #enrol_field label").addClass("no_disp"),$("form[name=admissionForm] #enrol_field label[for=ad_index]").removeClass("no_disp"),$("#ad_index").prop("readonly",!1)}),$("form[name=admissionForm]").submit(function(e){e.preventDefault(),fileUpload($(this),$(this).find("button[name=submit_admission]"),!0).then(e=>{time=5,!0===e?(message="Enrolment was successful. Please wait as your letters are prepared",type="success",messageBoxTimeout("admissionForm",message,type,3),setTimeout(function(){$("#handle_pdf")[0].click(),$("button[name=modal_cancel]").click()},3e3)):(type="error","no-transaction-id"==e?(message="No transaction id was provided",i=1):"no-index-number"==e?(message="No index number was provided",i=1):"profile-wrong-ext"==e?(message="Profile picture must be of type jpg, jpeg or png",i=1):"profile-pic-required"==e?(message="Please provide your profile picture",i=1):"no-enrolment-code"==e?(message="No enrolment code was provided",i=1,$("#ad_enrol_code").focus()):"enrolment-code-short"==e?(message="Your enrolment code should be 10 characters long",i=1,$("#ad_enrol_code").focus()):"enrolment-code-exist"==e?(message="The enrolment code <b>'"+$("#ad_enrol_code").val()+"'</b> already exists. Please check your placement form and provide a valid one",i=1,$("#ad_enrol_code").focus()):"wrong-school"==e?(message="Error with school name. Please report to admin",i=1):"no-aggeregate-score"==e?(message="Please enter your aggregate score",i=1):"no-course-set"==e?(message="Please provide the name of your selected program",i=1):"no-lname-set"==e?(message="Please provide your last name",i=1):"no-oname-set"==e?(message="Please provide your other name(s)",i=1):"no-gender-set"==e?(message="Please select your gender",i=1):"no-jhs-name-set"==e?(message="Please provide the name of your JHS",i=1):"no-jhs-town-set"==e?(message="Please provide the town in which JHS is found",i=1):"no-jhs-district-set"==e?(message="Please provide the district of your JHS",i=1):"no-year-set"==e?(message="Please select your year of birth",i=1):"no-month-set"==e?(message="Please select your month of birth",i=1):"no-day-set"==e?(message="Please select your day of birth",i=1):"no-birth-place-set"==e?(message="Please enter your place of birth",i=1):"no-father-name"==e?(message="Please provide your father's name",i=2):"no-f-occupation-set"==e?(message="Please provide your father's occupation",i=2):"no-mother-name"==e?(message="Please provide your mother's name",i=2):"no-m-occupation-set"==e?(message="Please provide your mother's occupation",i=2):"no-elder-name"==e?(message="Please provide your father, mother or a guardian",i=2):"no-residence-set"==e?(message="Please provide your residential address",i=2):"no-p-p-set"==e?(message="Please select your primary phone number",i=2):"p-p-short"==e?(message="Primary phone number is shorter than normal",i=2):"p-p-long"==e?(message="Primary phone number is longer than normal",i=2):"p-p-invalid"==e?(message="Primary phone number is not a invalid phone number",i=2):"s-p-short"==e?(message="Secondary phone number is shorter than normal",i=2):"s-p-long"==e?(message="Secondary phone number is longer than normal",i=2):"s-p-invalid"==e?(message="Secondary phone number is not a invalid phone number",i=2):"no-interest-set"==e?(message="Please select at least one interest",i=2):"no-witness-set"==e?(message="Please provide a witness' name",i=2):"no-witness-phone"==e?(message="Please provide your witness' phone number",i=2):"witness-phone-long"==e?(message="Witness' phone number is longer than normal",i=2):"witness-phone-short"==e?(message="Witness' phone number is shorter than normal",i=2):"witness-phone-invalid"==e?(message="Witness' phone number is not a valid phone number",i=2):(message=e,time=0),$(".tabs span.tab_button:nth-child("+i+")").click(),messageBoxTimeout("admissionForm",message,type,time))}).then(e=>{let a="";a="timeout"==e?"Connection was timed out due to a slow network. Please try again later":e.toString(),type="error",messageBoxTimeout(form_element.prop("name"),a,type)})}),$(".tab_button").click(function(){id=$(this).attr("id"),"sumView"==id?$("label[for=print_summary]").removeClass("no_disp"):$("label[for=print_summary]").addClass("no_disp")}),$("input#profile_pic").change(function(){""!=$(this).val()?$("#res_ad_profile_picture").text("Provided"):$("#res_ad_profile_picture").text("Not Set")}),$("label[for=print_summary] button").click(function(){let e=$("#"+$("#sumView").attr("data-views")).html();e=e.replace(/></g,">Not Defined<");const a=$("input#ad_index").val(),t="<style>\nfieldset{display: block;margin-bottom: 1cm;border: 1px solid black;}\n.joint{margin: 5px; display: flex; flex-wrap: wrap; gap: 5mm}\n.joint .label{flex: 1 1 auto; min-width: 40mm; border: 1px solid lightgrey;padding: 2mm 3mm;min-height: 1.25em;}\n.label .value{color: #222;font-variant: small-caps;}\n.ng-hide{display: none;}\n.cur_time{margin-top: 5mm; text-align: center;}\n.checkbox{margin-top: 3mm; padding: 2mm 2mm 1mm}\n</style>\n",n="Admission Summary | "+a;e+="\n<p class='cur_time'>Document Generated at "+printTime()+"</p>",printSection(e,t,n)});